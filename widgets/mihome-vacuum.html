<script type="text/javascript">
    'use strict';

    if (vis.editMode) {
        // Add words for basic widgets
        $.extend(true, systemDictionary, {
            // Bars
            "picVisible":       {"en": "Background",        "de": "Hintergrund",        "ru": "Фон"},
            "oid-state":        {"en": "ID state",          "de": "Zustands ID",        "ru": "ID старт/стоп"},
            "oid-home":         {"en": "ID go home",        "de": "ID zu Homebase",     "ru": "ID идти к базе"},
            "oid-connected":    {"en": "ID is connected",   "de": "ID ist verbunden",   "ru": "ID online"}
        });
    }
    vis.binds['mihome-vacuum'] = {
        onclick: function (el) {
            var oid = $(el).data('oid');
            if (oid) {
                if ($(el).data('type') === 'state') {
                    var val = vis.states[oid + '.val'];
                    vis.setValue(oid, val !== 'true' && val !== true);
                } else {
                    vis.setValue(oid, true);
                }
            }
        }
    };
</script>
<script id="tplXiaomiVacuum"
        type="text/ejs"
        class="vis-tpl"
        data-vis-type="ctrl"
        data-vis-set="mihome-vacuum"
        data-vis-name="Control"
        data-vis-prev='<img src="widgets/mihome-vacuum/img/previewControl.png"></img>'
        data-vis-attrs="oid-state;oid-home;oid-connected;picVisible[true]/checkbox;"
>
    <div class="vis-widget <%== this.data.attr('class') %>" style="width: 130px; height: 130px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" style="overflow: visible">
        <img src="widgets/mihome-vacuum/img/vacuum.png" style="width: 100%; height: 100%; <%= this.data.picVisible === true || this.data.picVisible === 'true' ? '' : 'display: none' %>"/>
        <div style="position: absolute;width: 33%;top: 0;left: 31%;border: 4px solid black; height: calc(100% - 8px);border-radius: 100px;">
            <div style="width: calc(100% - 8px); border: 4px solid <%= vis.states.attr(this.data['oid-connected'] + '.val') ? '#C6D4FF' : 'gray' %>; height: calc(100% - 8px); border-radius: 100px;
            /* Permalink - use to edit and share this gradient: http://colorzilla.com/gradient-editor/#9e9e9e+0,4c4c4c+100,4c4c4c+100 */
        background: rgb(158,158,158); /* Old browsers */
        background: -moz-linear-gradient(left,  rgba(158,158,158,1) 0%, rgba(76,76,76,1) 100%, rgba(76,76,76,1) 100%); /* FF3.6-15 */
        background: -webkit-linear-gradient(left,  rgba(158,158,158,1) 0%,rgba(76,76,76,1) 100%,rgba(76,76,76,1) 100%); /* Chrome10-25,Safari5.1-6 */
        background: linear-gradient(to right,  rgba(158,158,158,1) 0%,rgba(76,76,76,1) 100%,rgba(76,76,76,1) 100%); /* W3C, IE10+, FF16+, Chrome26+, Opera12+, Safari7+ */
        filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#9e9e9e', endColorstr='#4c4c4c',GradientType=1 ); /* IE6-9 */
        ">
            </div>
            <img onclick="vis.binds['mihome-vacuum'].onclick(this)" data-type="state" data-oid="<%= this.data['oid-state'] %>" style="position: absolute;width: 60%;left: 20%;top: 15%;<%= this.data['oid-state'] ? 'cursor: pointer;' : '' %>" src="widgets/mihome-vacuum/img/<%= vis.states.attr(this.data['oid-state'] + '.val') ? 'on' : 'off' %>.png"  />
            <img onclick="vis.binds['mihome-vacuum'].onclick(this)" data-oid="<%= this.data['oid-home'] %>" style="position: absolute;width: 60%;left: 20%;bottom: 15%;cursor: pointer;<%= this.data['oid-home'] ? 'cursor: pointer;' : '' %>" src="widgets/mihome-vacuum/img/home.png" />
        </div>
        </div>
    </div>
</script>
